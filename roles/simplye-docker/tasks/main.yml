---
- name: Copy the logs cat script to host
  copy:
    src: files/logs.sh
    dest: /home/ec2-user/logs.sh
    mode: 0775
  become: yes

- name: Copy the bash start script to host
  copy:
    src: files/bash.sh
    dest: /home/ec2-user/bash.sh
    mode: 0775
  become: yes

- name: Assign Route 53 subdomain to this instance
  route53:
    region: "{{ aws_region }}"
    state: present
    zone: "{{ route_domain }}"
    record: "{{ route_name }}.{{ route_domain }}"
    type: A
    ttl: 300
    value: "{{ hostvars['localhost'].ec2_ip }}"
    wait: yes

- local_action:
    module: ec2
    region: "{{ aws_region }}"
    instance_tags:
      Name: "{{ simplye_role }}-{{ simplye_instance_name }}"
    state: restarted
